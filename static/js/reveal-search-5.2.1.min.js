!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).RevealSearch=t()}(this,function(){"use strict";return()=>{let g,e,t,n,o,l,i;function s(){(e=document.createElement("div")).classList.add("searchbox"),e.style.position="absolute",e.style.top="10px",e.style.right="10px",e.style.zIndex=10,e.innerHTML='<input type="search" class="searchinput" placeholder="Search..." style="vertical-align: top;"/>\n\t\t</span>',(t=e.querySelector(".searchinput")).style.width="240px",t.style.fontSize="14px",t.style.padding="4px 6px",t.style.color="#000",t.style.background="#fff",t.style.borderRadius="2px",t.style.border="0",t.style.outline="0",t.style.boxShadow="0 2px 18px rgba(0, 0, 0, 0.2)",t.style["-webkit-appearance"]="none",g.getRevealElement().appendChild(e),t.addEventListener("keyup",function(e){l=13!==e.keyCode||(e.preventDefault(),l&&(""===(e=t.value)?(i&&i.remove(),n=null):(i=new c("slidecontent"),n=i.apply(e),o=0)),n&&(n.length&&n.length<=o&&(o=0),n.length>o&&(g.slide(n[o].h,n[o].v),o++)),!1)},!1),d()}function r(){e||s(),e.style.display="inline",t.focus(),t.select()}function d(){e||s(),e.style.display="none",i&&i.remove()}function a(){e||s(),("inline"!==e.style.display?r:d)()}function c(e,t){var n=document.getElementById(e)||document.body,a=t||"EM",c=new RegExp("^(?:"+a+"|SCRIPT|FORM)$"),u=["#ff6","#a0ffff","#9f9","#f99","#f6f"],f=[],p=0,h="",y=[];this.setRegex=function(e){e=e.trim(),h=new RegExp("("+e+")","i")},this.getRegex=function(){return h.toString().replace(/^\/\\b\(|\)\\b\/i$/g,"").replace(/\|/g," ")},this.hiliteWords=function(e){if(null!=e&&e&&h&&!c.test(e.nodeName)){if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)this.hiliteWords(e.childNodes[t]);var n;if(3==e.nodeType&&(n=e.nodeValue)&&(n=h.exec(n))){for(var o=e;null!=o&&"SECTION"!=o.nodeName;)o=o.parentNode;for(var l=g.getIndices(o),i=y.length,s=!1,t=0;t<i;t++)y[t].h===l.h&&y[t].v===l.v&&(s=!0);s||y.push(l),f[n[0].toLowerCase()]||(f[n[0].toLowerCase()]=u[p++%u.length]);var r=document.createElement(a),d=(r.appendChild(document.createTextNode(n[0])),r.style.backgroundColor=f[n[0].toLowerCase()],r.style.fontStyle="inherit",r.style.color="#000",e.splitText(n.index));d.nodeValue=d.nodeValue.substring(n[0].length),e.parentNode.insertBefore(r,d)}}},this.remove=function(){for(var e,t=document.getElementsByTagName(a);t.length&&(e=t[0]);)e.parentNode.replaceChild(e.firstChild,e)},this.apply=function(e){if(null!=e&&e)return this.remove(),this.setRegex(e),this.hiliteWords(n),y}}return{id:"search",init:e=>{(g=e).registerKeyboardShortcut("CTRL + Shift + F","Search"),document.addEventListener("keydown",function(e){"F"==e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),a())},!1)},open:r,close:d,toggle:a}}});